---
openapi: 3.0.3
info:
  title: PROXIA-MES Monitoring-Dashboard GUI-Service API
  description: PROXIA-MES Monitoring-Dashboard GUI-Service API
  version: '1.0.29'
servers:
  - url: "http://localhost:8080/proxia-mes/monitoring-dashboard/gui-service/v1"
tags:
  - name: dashboards
    description: Everything about dashboards
  - name: resources
    description: Everything about resources
paths:
  "/dashboards":
    get:
      tags:
        - dashboards
      summary: returns all dashboards for a user
      parameters:
        - name: userId
          in: query
          required: true
          style: form
          schema:
            $ref: "#/components/schemas/userId"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/dashboards"
        '204':
          description: No Content
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '500':
          description: Internal Server Error
          content: { }
  "/dashboard/{userId}/{dashboardId}":
    delete:
      tags:
        - dashboards
      summary: deletes a dashboard for a user
      parameters:
        - name: userId
          in: path
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/userId"
        - name: dashboardId
          in: path
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/dashboardId"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/dashboard"
        '204':
          description: No Content
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '500':
          description: Internal Server Error
          content: { }
    get:
      tags:
        - dashboards
      summary: returns a dashboard for a user
      parameters:
        - name: userId
          in: path
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/userId"
        - name: dashboardId
          in: path
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/dashboardId"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/dashboard"
        '204':
          description: No Content
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '500':
          description: Internal Server Error
          content: { }
  "/dashboard/{userId}":
    post:
      tags:
        - dashboards
      summary: adds a new dashboard for a user
      security:
        - OpenID:
            - admin
      parameters:
        - name: userId
          in: path
          description: the userId
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/userId"
      requestBody:
        description: dashboard object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/dashboard"
        required: true
      responses:
        '200':
          description: OK
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '409':
          description: Conflict
          content: { }
        '500':
          description: Internal Server Error
          content: { }
    put:
      tags:
        - dashboards
      summary: modifies an existing dashboard for a user
      security:
        - OpenID:
            - admin
      parameters:
        - name: userId
          in: path
          description: the userId
          required: true
          style: simple
          schema:
            $ref: "#/components/schemas/userId"
      requestBody:
        description: dashboard object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/dashboard"
        required: true
      responses:
        '200':
          description: OK
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '409':
          description: Conflict
          content: { }
        '500':
          description: Internal Server Error
          content: { }
  "/resources":
    get:
      tags:
        - resources
      summary: returns all resources by groups
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/resources"
        '204':
          description: No Content
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '500':
          description: Internal Server Error
          content: { }
  "/resource-statuses":
    get:
      tags:
        - resources
      summary: returns all resource-status by groups
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/resourceStatuses"
        '204':
          description: No Content
          content: { }
        '400':
          description: Bad Request
          content: { }
        '401':
          description: Unauthorized
          content: { }
        '403':
          description: Forbidden
          content: { }
        '500':
          description: Internal Server Error
          content: { }
components:
  securitySchemes:
    OpenID:
      type: openIdConnect
      openIdConnectUrl: http://localhost:8080/auth/realms/xi-mes/.well-known/openid-configuration
  schemas:
    userId:
      type: string
      description: the userId
      maxLength: 255
      minLength: 3
    dashboardId:
      type: string
      description: The unque id of a dashboard (UUID4)
      example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
      maxLength: 50
      minLength: 10
    dashboards:
      type: array
      items:
        $ref: '#/components/schemas/dashboard'
    dashboard:
      type: object
      required:
        - id
        - name
      properties:
        id:
          $ref: '#/components/schemas/dashboardId'
        name:
          type: string
          description: The name of a dashboard
          maxLength: 100
          minLength: 3
        description:
          type: string
          description: The description of a dashboard
          maxLength: 255
          minLength: 0
    widget:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: The unque id of a widget (UUID4)
          example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
          maxLength: 50
          minLength: 10
        name:
          type: string
          description: The name of a widget
          maxLength: 100
          minLength: 3
        description:
          type: string
          description: The description of a widget
          maxLength: 255
          minLength: 0
        x:
          type: number
          format: int32
          minimum: 0
          maximum: 100
        y:
          type: number
          format: int32
          minimum: 0
          maximum: 100
        cols:
          type: number
          format: int32
          minimum: 1
          maximum: 100
        rows:
          type: number
          format: int32
          minimum: 1
          maximum: 100
        threshold:
          type: object
          properties:
            low:
              $ref: '#/components/schemas/threshold'
            medium:
              $ref: '#/components/schemas/threshold'
            high:
              $ref: '#/components/schemas/threshold'
        resource-status-widget:
          $ref: '#/components/schemas/resource-status-widget'
        processing-degree-widget:
          $ref: '#/components/schemas/processing-degree-widget'
        planning-accuracy-widget:
          $ref: '#/components/schemas/planning-accuracy-widget'
    planning-accuracy-widget:
      type: object
      required:
        - dummy
      properties:
        dummy:
          type: string
          description: Not implemented yet
    processing-degree-widget:
      type: object
      required:
        - dummy
      properties:
        dummy:
          type: string
          description: Not implemented yet
    resource-status-widget:
      type: object
      required:
        - resources
        - resourceStatuses
        - chart
      properties:
        resources:
          type: array
          items:
            type: string
            description: The unque id of a resource status (UUID4 or C_<String>)
            example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
            maxLength: 50
            minLength: 3
          minItems: 0
          maxItems: 100
        resourceStatuses:
          type: array
          items:
            type: string
            description: The unque id of a resource status (UUID4 or C_<String>)
            example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
            maxLength: 50
            minLength: 3
          minItems: 0
          maxItems: 100
        chart:
          type: string
          enum:
            - 'aggregated'
            - 'detail'
    threshold:
      type: object
      description: a treshold of a widget
      properties:
        value:
          type: string
          description: the value of the threshold
          minLength: 1
          maxLength: 50
        duration:
          type: number
          format: int32
          default: 1
          minimum: 1
          maximum: 60
          description: the number of widget time units the value must exceed the threshold
    resourceId:
      type: string
      description: The unque id of a resource or group (UUID4 or C_<String>)
      example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
      maxLength: 50
      minLength: 3
    resourceName:
      type: string
      description: The name of a resource or group
      maxLength: 50
      minLength: 3
    resources:
      type: array
      items:
        $ref: '#/components/schemas/resourceMainGroup'
    resourceMainGroup:
      type: object
      required:
        - id
        - name
        - resourceGroups
      properties:
        id:
          $ref: '#/components/schemas/resourceId'
        name:
          $ref: '#/components/schemas/resourceName'
        resourceGroups:
          type: array
          items:
            $ref: '#/components/schemas/resourceGroup'
          minItems: 0
          maxItems: 100
    resourceGroup:
      type: object
      required:
        - id
        - name
        - resources
      properties:
        id:
          $ref: '#/components/schemas/resourceId'
        name:
          $ref: '#/components/schemas/resourceName'
        resources:
          type: array
          items:
            $ref: '#/components/schemas/resource'
          minItems: 0
          maxItems: 100
    resource:
      type: object
      required:
        - id
        - name
        - type
        - plant
        - state
      properties:
        id:
          $ref: '#/components/schemas/resourceId'
        name:
          $ref: '#/components/schemas/resourceName'
        type:
          type: string
          description: The type of the resource
          maxLength: 255
          minLength: 3
        plant:
          type: string
          description: The plant of the resource
          maxLength: 255
          minLength: 3
        state:
          type: string
          description: The current state of the resource
          maxLength: 255
          minLength: 3
    resourceStatusId:
      type: string
      description: The unque id of a resource status or group (UUID4 or C_<String>)
      example: 2a6783cc-f1b4-4b74-9fd8-e6460e9a0028
      maxLength: 50
      minLength: 3
    resourceStatusName:
      type: string
      description: The name of a resource status or group
      maxLength: 50
      minLength: 3
    resourceStatuses:
      type: array
      items:
        $ref: '#/components/schemas/resourceStatusMainGroup'
    resourceStatusMainGroup:
      type: object
      required:
        - id
        - name
        - resourceStatusGroups
      properties:
        id:
          $ref: '#/components/schemas/resourceStatusId'
        name:
          $ref: '#/components/schemas/resourceStatusName'
        resourceStatusGroups:
          type: array
          items:
            $ref: '#/components/schemas/resourceStatusGroup'
          minItems: 0
          maxItems: 100
    resourceStatusGroup:
      type: object
      required:
        - id
        - name
        - resources
      properties:
        id:
          $ref: '#/components/schemas/resourceStatusId'
        name:
          $ref: '#/components/schemas/resourceStatusName'
        resourceStatuses:
          type: array
          items:
            $ref: '#/components/schemas/resourceStatus'
          minItems: 0
          maxItems: 100
    resourceStatus:
      type: object
      required:
        - id
        - name
      properties:
        id:
          $ref: '#/components/schemas/resourceStatusId'
        name:
          $ref: '#/components/schemas/resourceStatusName'
                